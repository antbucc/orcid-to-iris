{"ast":null,"code":"import { parseStringPromise } from \"xml2js\";\nexport async function fetchPublications(orcidId) {\n  var _result$activitiesSu, _result$activitiesSu$;\n  const url = `https://pub.orcid.org/v3.0/${orcidId}/activities`;\n  const response = await fetch(url, {\n    headers: {\n      Accept: \"application/json\"\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch publications\");\n  }\n  const result = await response.json();\n  console.log(\"API Response:\", result);\n  const works = result === null || result === void 0 ? void 0 : (_result$activitiesSu = result[\"activities-summary\"]) === null || _result$activitiesSu === void 0 ? void 0 : (_result$activitiesSu$ = _result$activitiesSu[\"works\"]) === null || _result$activitiesSu$ === void 0 ? void 0 : _result$activitiesSu$[\"group\"];\n  if (!works || works.length === 0) {\n    console.error(\"No works found.\");\n    return [];\n  }\n  const publications = works.flatMap(group => {\n    return group[\"work-summary\"].map(summary => {\n      var _summary$title, _summary$title$title, _summary$externalIds, _summary$externalIds$, _summary$externalIds$2, _summary$journalTitl, _summary$publication, _summary$publication$;\n      return {\n        title: (summary === null || summary === void 0 ? void 0 : (_summary$title = summary[\"title\"]) === null || _summary$title === void 0 ? void 0 : (_summary$title$title = _summary$title[\"title\"]) === null || _summary$title$title === void 0 ? void 0 : _summary$title$title[\"value\"]) || \"Unknown Title\",\n        doi: (summary === null || summary === void 0 ? void 0 : (_summary$externalIds = summary[\"external-ids\"]) === null || _summary$externalIds === void 0 ? void 0 : (_summary$externalIds$ = _summary$externalIds[\"external-id\"]) === null || _summary$externalIds$ === void 0 ? void 0 : (_summary$externalIds$2 = _summary$externalIds$.find(id => id[\"external-id-type\"] === \"doi\")) === null || _summary$externalIds$2 === void 0 ? void 0 : _summary$externalIds$2[\"external-id-value\"]) || null,\n        journal: (summary === null || summary === void 0 ? void 0 : (_summary$journalTitl = summary[\"journal-title\"]) === null || _summary$journalTitl === void 0 ? void 0 : _summary$journalTitl[\"value\"]) || \"Unknown Journal\",\n        year: (summary === null || summary === void 0 ? void 0 : (_summary$publication = summary[\"publication-date\"]) === null || _summary$publication === void 0 ? void 0 : (_summary$publication$ = _summary$publication[\"year\"]) === null || _summary$publication$ === void 0 ? void 0 : _summary$publication$[\"value\"]) || \"Unknown Year\"\n      };\n    });\n  });\n  return publications;\n}","map":{"version":3,"names":["parseStringPromise","fetchPublications","orcidId","_result$activitiesSu","_result$activitiesSu$","url","response","fetch","headers","Accept","ok","Error","result","json","console","log","works","length","error","publications","flatMap","group","map","summary","_summary$title","_summary$title$title","_summary$externalIds","_summary$externalIds$","_summary$externalIds$2","_summary$journalTitl","_summary$publication","_summary$publication$","title","doi","find","id","journal","year"],"sources":["/Users/bucchiarone/Library/Mobile Documents/com~apple~CloudDocs/Documents/Documents - Antonioâ€™s MacBook Pro/Projects/orcid-to-iris/orcid-to-iris/orcid-to-iris/src/services/orcidService.js"],"sourcesContent":["import { parseStringPromise } from \"xml2js\";\n\nexport async function fetchPublications(orcidId) {\n    const url = `https://pub.orcid.org/v3.0/${orcidId}/activities`;\n  \n    const response = await fetch(url, {\n      headers: {\n        Accept: \"application/json\",\n      },\n    });\n  \n    if (!response.ok) {\n      throw new Error(\"Failed to fetch publications\");\n    }\n  \n    const result = await response.json();\n    console.log(\"API Response:\", result);\n  \n    const works = result?.[\"activities-summary\"]?.[\"works\"]?.[\"group\"];\n    if (!works || works.length === 0) {\n      console.error(\"No works found.\");\n      return [];\n    }\n  \n    const publications = works.flatMap((group) => {\n      return group[\"work-summary\"].map((summary) => {\n        return {\n          title: summary?.[\"title\"]?.[\"title\"]?.[\"value\"] || \"Unknown Title\",\n          doi: summary?.[\"external-ids\"]?.[\"external-id\"]?.find((id) => id[\"external-id-type\"] === \"doi\")?.[\"external-id-value\"] || null,\n          journal: summary?.[\"journal-title\"]?.[\"value\"] || \"Unknown Journal\",\n          year: summary?.[\"publication-date\"]?.[\"year\"]?.[\"value\"] || \"Unknown Year\",\n        };\n      });\n    });\n  \n    return publications;\n  }\n  "],"mappings":"AAAA,SAASA,kBAAkB,QAAQ,QAAQ;AAE3C,OAAO,eAAeC,iBAAiBA,CAACC,OAAO,EAAE;EAAA,IAAAC,oBAAA,EAAAC,qBAAA;EAC7C,MAAMC,GAAG,GAAG,8BAA8BH,OAAO,aAAa;EAE9D,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAACF,GAAG,EAAE;IAChCG,OAAO,EAAE;MACPC,MAAM,EAAE;IACV;EACF,CAAC,CAAC;EAEF,IAAI,CAACH,QAAQ,CAACI,EAAE,EAAE;IAChB,MAAM,IAAIC,KAAK,CAAC,8BAA8B,CAAC;EACjD;EAEA,MAAMC,MAAM,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;EACpCC,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEH,MAAM,CAAC;EAEpC,MAAMI,KAAK,GAAGJ,MAAM,aAANA,MAAM,wBAAAT,oBAAA,GAANS,MAAM,CAAG,oBAAoB,CAAC,cAAAT,oBAAA,wBAAAC,qBAAA,GAA9BD,oBAAA,CAAiC,OAAO,CAAC,cAAAC,qBAAA,uBAAzCA,qBAAA,CAA4C,OAAO,CAAC;EAClE,IAAI,CAACY,KAAK,IAAIA,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;IAChCH,OAAO,CAACI,KAAK,CAAC,iBAAiB,CAAC;IAChC,OAAO,EAAE;EACX;EAEA,MAAMC,YAAY,GAAGH,KAAK,CAACI,OAAO,CAAEC,KAAK,IAAK;IAC5C,OAAOA,KAAK,CAAC,cAAc,CAAC,CAACC,GAAG,CAAEC,OAAO,IAAK;MAAA,IAAAC,cAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAAC,sBAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,qBAAA;MAC5C,OAAO;QACLC,KAAK,EAAE,CAAAT,OAAO,aAAPA,OAAO,wBAAAC,cAAA,GAAPD,OAAO,CAAG,OAAO,CAAC,cAAAC,cAAA,wBAAAC,oBAAA,GAAlBD,cAAA,CAAqB,OAAO,CAAC,cAAAC,oBAAA,uBAA7BA,oBAAA,CAAgC,OAAO,CAAC,KAAI,eAAe;QAClEQ,GAAG,EAAE,CAAAV,OAAO,aAAPA,OAAO,wBAAAG,oBAAA,GAAPH,OAAO,CAAG,cAAc,CAAC,cAAAG,oBAAA,wBAAAC,qBAAA,GAAzBD,oBAAA,CAA4B,aAAa,CAAC,cAAAC,qBAAA,wBAAAC,sBAAA,GAA1CD,qBAAA,CAA4CO,IAAI,CAAEC,EAAE,IAAKA,EAAE,CAAC,kBAAkB,CAAC,KAAK,KAAK,CAAC,cAAAP,sBAAA,uBAA1FA,sBAAA,CAA6F,mBAAmB,CAAC,KAAI,IAAI;QAC9HQ,OAAO,EAAE,CAAAb,OAAO,aAAPA,OAAO,wBAAAM,oBAAA,GAAPN,OAAO,CAAG,eAAe,CAAC,cAAAM,oBAAA,uBAA1BA,oBAAA,CAA6B,OAAO,CAAC,KAAI,iBAAiB;QACnEQ,IAAI,EAAE,CAAAd,OAAO,aAAPA,OAAO,wBAAAO,oBAAA,GAAPP,OAAO,CAAG,kBAAkB,CAAC,cAAAO,oBAAA,wBAAAC,qBAAA,GAA7BD,oBAAA,CAAgC,MAAM,CAAC,cAAAC,qBAAA,uBAAvCA,qBAAA,CAA0C,OAAO,CAAC,KAAI;MAC9D,CAAC;IACH,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,OAAOZ,YAAY;AACrB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}